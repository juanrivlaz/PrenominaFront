<div class="container module-container">
    <div class="ctn-filter">
        <div class="ctn-others">
            <div class="ctn-search">
                <div class="input-search">
                    <input type="search" name="search" id="search" placeholder="Buscar">
                    <mat-icon>search</mat-icon>
                </div>
            </div>
        </div>
    </div>

    <table mat-table #table [dataSource]="dataSource">
        <ng-container matColumnDef="employee">
            <th mat-header-cell *matHeaderCellDef> Empleado </th>
            <td mat-cell *matCellDef="let row" class="name">
                <div class="ctn-name">
                    <app-avatar [name]="row.employeeName" />
                    <div class="labels">
                        <p>{{row.employeeName}}</p>
                        <span>Cod. {{row.employeeCode}} | {{row.employeeActivity}}</span>
                    </div>
                </div>
            </td>
        </ng-container>
        <ng-container matColumnDef="incidentCode">
            <th mat-header-cell *matHeaderCellDef> Incidencia </th>
            <td mat-cell *matCellDef="let row" [matTooltip]="row.incidentDescription"> {{row.incidentCode}} </td>
        </ng-container>
        <ng-container matColumnDef="startDate">
            <th mat-header-cell *matHeaderCellDef> Fecha Inicio </th>
            <td mat-cell *matCellDef="let row"> {{row.startDate | date}} </td>
        </ng-container>
        <ng-container matColumnDef="endDate">
            <th mat-header-cell *matHeaderCellDef> Fecha Fin </th>
            <td mat-cell *matCellDef="let row"> {{row.endDate | date}} </td>
        </ng-container>
        <ng-container matColumnDef="notes">
            <th mat-header-cell *matHeaderCellDef> Notas </th>
            <td mat-cell *matCellDef="let row" [matTooltip]="row.notes"> {{row.sortNote}} </td>
        </ng-container>
        <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef> Estado </th>
            <td mat-cell *matCellDef="let row"> {{row.statusLabel}} </td>
        </ng-container>
        <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef> Fecha de Creaci√≥n </th>
            <td mat-cell *matCellDef="let row"> {{row.createdAt | date}} </td>
        </ng-container>
        <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef> Acciones </th>
            <td mat-cell *matCellDef="let row">
                @if (row.status === statusPending) {
                    <div class="ctn-actions">
                        <button mat-button (click)="handleClickAction(true, row)"><mat-icon>done</mat-icon>Aprobar</button>
                        <button mat-button class="warning" (click)="handleClickAction(false, row)"><mat-icon>close</mat-icon>Rechazar</button>
                    </div>
                } @else if (row.status === statusApproved) {
                    <button mat-button (click)="downloadFile(row.id)" class="btn-download">
                        <img src="assets/icons/pdf.png" alt="pdf" class="mr-12" width="25px">
                        PDF
                    </button>
                } @else if (row.status === statusRejected) {
                    <span>Rechazada</span>
                }
            </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="columns"></tr>
        <tr mat-row *matRowDef="let row; columns: columns;"></tr>
    </table>
</div>